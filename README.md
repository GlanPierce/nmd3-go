
-----

# 棋道争锋 

这是一个基于 Java Spring Boot 和 H5 构建的全功能网页游戏，旨在致敬和复刻热门游戏 **《忍者必须死3》（Ninja Must Die 3）** 中的经典PVP活动小游戏：**棋道争锋**。

本项目完整实现了原游戏的核心玩法，包括伏兵、落子、连接数计算、额外回合等机制，并通过 Spring Boot 提供了稳定的后端服务和用于游玩的前端页面。

## 游戏特性

* **完整后端逻辑:** 使用 Spring Boot (Controller, Service, Repository) 分层架构实现所有游戏规则。
* **实时对战前端:** 使用原生 HTML/CSS/JavaScript 构建，通过轮询（Polling）机制获取最新游戏状态。
* **回合计时器:** 实现了“伏兵阶段”和“落子阶段”的15秒倒计时，超时将由服务器自动执行随机操作。
* **排行榜系统:** 游戏结束后自动结算积分（胜+3，负-2）并更新排行榜。
* **开发者模式:** 前端提供“开发者模式”选项，勾选后可查看双方设置的所有伏兵位置。

## 技术栈

* **后端 (Backend):**
    * Java 17
    * Spring Boot 3 (Web, DevTools)
    * Spring Scheduling (`@Scheduled`) (用于实现倒计时器)
    * Maven
* **前端 (Frontend):**
    * HTML5
    * CSS3
    * JavaScript (ES6+)
* **架构:**
    * RESTful API
    * 内存存储 (使用 `ConcurrentHashMap` 替代数据库)

## 如何运行

### 1\. 环境准备

* JDK 17 或更高版本
* Apache Maven 3.8+
* 一个可用的端口（默认为 `8080`）

### 2\. 克隆并运行

```bash
# 1. 克隆项目 (或下载ZIP)
# git clone [你的Git仓库地址]
# cd [项目目录]

# 2. (推荐) 使用 Maven 包装器运行
./mvnw spring-boot:run

# 或者 (如果你已安装 Maven)
mvn spring-boot:run
```

* 项目已配置 `spring-boot-devtools`，在您修改后端的 `.java` 文件并保存时，服务将自动热重载。

### 3\. 开始游玩

1.  打开您的浏览器并访问 `http://localhost:8087`。
2.  点击 **"开始新游戏"**。
3.  **(模拟对战)** 您可以在两个浏览器窗口（或浏览器的两个标签页）中打开该页面：
    * 一个窗口选择 **“你的身份: 玩家1”**
    * 另一个窗口选择 **“你的身份: 玩家2”**
4.  双方即可在各自的窗口进行操作（如伏兵、落子），游戏状态会通过轮询（每秒）在双方屏幕上同步。

-----

## 游戏规则 (复刻)

### 1\. 棋盘

* 战场由一个 $6 \times 6$ 的棋盘构成。

### 2\. 常规轮次 (共 4 轮)

* **伏兵阶段 (15秒):** 双方玩家同时进行 2 次伏兵。
    * 伏兵可设置在任意空棋盘格上。
* **落子阶段 (每步 15 秒):** 之后根据先后手分别进行 3 次落子。
    * 随机先手的一方将在 1、4 轮获得先手。
    * 另一方则在 2、3 轮获得先手。
    * 落子可设置在任意未被占领的棋盘格上。

### 3\. 伏兵与连接

* **最大连接:** 落子后，横向或竖向紧挨着相连的棋子被视为有效连接。
* **伏兵触发:** 玩家落子在**任意**伏兵格（无论敌我）时会触发伏兵。
    * 触发后，该格子上本次的玩家落子和所有伏兵均会失效（消失）。
    * 同时，在此设置伏兵的**真正主人**获得 1 次额外落子机会。

### 4\. 额外轮次

* 4 个常规轮次后进行。
* 双方按照 1 人 1 次的方式进行落子。
* 额外落子次数更多的忍者获得先手。
* 此阶段触发伏兵**不会**再获得额外落子次数。

### 5\. 胜负及结算

* **胜负判定 (按优先级比较)：**
    * 1.  比较双方的**最大连接数**。
    * 2.  若连接数相同，则比较棋盘上**落子子数**。
    * 3.  如果仍然一致，将被算做平局。
* **积分结算:**
    * 玩家胜利时可获得 3 积分。
    * 失败时会被扣除 2 积分。